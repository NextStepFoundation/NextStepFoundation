function AutoComplete(){var u=this;function l(e){u.autocomplete.value=e,$(u.autocomplete).attr("data-value",e),u.resultsHTML.innerHTML="",u.resultsHTML.style.display="none"}function a(){var e,t=this.value.trim();if(u.resultsHTML.innerHTML="",0<t.length&&""!=(e=function(e){var t=[],l=u.data;for(i=0;i<l.length;i++)(l[i].value.toLowerCase().includes(e.toLowerCase())||l[i].name.toLowerCase().includes(e.toLowerCase()))&&t.push(l[i]);return t.length?t.sort():""}(t)))for(u.resultsHTML.style.display="block",i=0;i<e.length;i++)u.resultsHTML.innerHTML+='<li aria-label="'+e[i].value+'" data-value="'+e[i].value+'">'+e[i].name+"</li>"}function s(e){var t=u.resultsHTML,i=t.getElementsByTagName("li").length-1;""==this.value.trim()||i<0||(40===e.which?(u.index++,u.liSelected&&(n(u.liSelected,"selected"),next=t.getElementsByTagName("li")[u.index],u.index<=i)?u.liSelected=next:(u.index=0,u.liSelected=t.getElementsByTagName("li")[0]),o(u.liSelected,"selected")):38===e.which?(u.liSelected?(n(u.liSelected,"selected"),u.index--,next=t.getElementsByTagName("li")[u.index],0<=u.index?u.liSelected=next:(u.index=i,u.liSelected=t.getElementsByTagName("li")[i])):(u.index=0,u.liSelected=t.getElementsByTagName("li")[i]),o(u.liSelected,"selected")):13===e.which&&l($(t).find("li.selected").data().value))}function n(e,t){e.classList?e.classList.remove(t):e.className=e.className.replace(new RegExp("(^|\\b)"+t.split(" ").join("|")+"(\\b|$)","gi")," ")}function o(e,t){e.classList?e.classList.add(t):e.className+=" "+t;var i,t=u.resultsHTML,l=e,a=.5,s=(l=function(e){var t=e.parentNode.getBoundingClientRect(),i=e.getBoundingClientRect(),l={};return l.top=i.top-t.top+e.parentNode.scrollTop,l.right=i.right-t.right,l.bottom=i.bottom-t.bottom,l.left=i.left-t.left,l}(e),t),e=l.top,n=a,o=void 0,r=s.scrollTop,c=e-r,d=performance.now();!function e(){var t;i=performance.now(),i=(i-d)/1e3/n,s.scrollTop=r+c*((t=i)<.5?2*t*t:(4-2*t)*t-1),i<1?window.requestAnimationFrame(e):o&&o()}()}this.init=function(e,t,i){return this.data=i,this.autocomplete=document.getElementById(e),this.resultsHTML=document.getElementById(t),this.index=-1,this.liSelected=null,this.autocomplete.oninput=a,this.autocomplete.onfocus=a,this.autocomplete.onblur=function(){u.index=-1,u.liSelected=null,setTimeout(function(){u.resultsHTML.innerHTML="",u.resultsHTML.style.display="none"},200)},this.autocomplete.onkeydown=s,this.resultsHTML.onclick=function(e){l(e.target.dataset.value)},this},this.updateData=function(e){this.data=e}}function MilitaryCodeSearchV2(){var a=this;this._autoComplete=null,this._defaultQuery="q=*:*&rows=0&wt=json&fq=custom_s_table:%22Military%20Estimator%22&fq=custom_s_military_enabled:Yes&facet=true&facet.mincount=1&facet.limit=500",this._solarEndPoint="/handlers/solrproxy.ashx?solrurl="+searchIndex+"/select?",this._branch="",this._skill="",this._occupationCode="",this._branchDropdown=$("#military-branch"),this._skillDropdown=$("#military-skill-level"),this._mosTextbox=$("#military-occupational-code"),this._searchBtn=$("#military-search"),this._customLabels=[{branch:"",skillLevel:"Skill Level",OccupationCode:"Enter Occupation Code"},{branch:"Air Force/Space Force",skillLevel:"CCAF Graduate?",OccupationCode:"Enter AFSC (ex. 3P031)"},{branch:"Army",skillLevel:"Skill Level",OccupationCode:"Enter MOS (ex. 11B)"},{branch:"Coast Guard",skillLevel:"Rate",OccupationCode:"Enter Rating (ex. BM)"},{branch:"Marines",skillLevel:"Rank",OccupationCode:"Enter MOS (ex. 5811)"},{branch:"Navy",skillLevel:"Rate",OccupationCode:"Enter Rating (ex. HM)"}],this.init=function(){1===$(".credit-calculator").length&&"undefined"!=typeof CrownPeakSearch&&(this.addEventListeners(),a.getBranches(),this._autoComplete=(new AutoComplete).init("military-occupational-code","occupational-code-results",[]),this.disableMilitaryCalculatorFields(),setTimeout(function(){a.clearMilitaryCalculatorFields(),a.disableMilitaryCalculatorFields()},100))},this.getBranches=function(){var e=this.buildQuery("&facet.field=custom_s_branch&facet.sort");$.get(e,null,function(e){e=a.parseDropdownData(e.facet_counts.facet_fields,"custom_s_branch");a.addDropdownOptions(a._branchDropdown,e)},"json")},this.getSkillLevels=function(){var e=this.buildQuery('&fq=custom_s_branch:"'+a._branch+'"&facet.field=custom_s_skill_level&facet.sort');$.get(e,null,function(e){e=a.parseDropdownData(e.facet_counts.facet_fields,"custom_s_skill_level");0<e.length&&(a._skillDropdown.removeAttr("disabled"),a.addDropdownOptions(a._skillDropdown,e))},"json")},this.getOccupationalCodes=function(){var e=this.buildQuery('&fq=custom_s_branch:"'+a._branch+'"&fq=custom_s_skill_level:"'+a._skill+'"&facet.field=custom_s_occupation_code&facet.sort');$.get(e,null,function(e){e=a.parseDropdownData(e.facet_counts.facet_fields,"custom_s_occupation_code");0<e.length&&a._autoComplete.updateData(e)},"json")},this.addDropdownOptions=function(t,e){e.forEach(function(e){e=new Option(e.name||e.value,e.value);t.append(e)}),t.prop("selectedIndex",0)},this.buildQuery=function(e){return decodeURI(this._solarEndPoint+this._defaultQuery+e)},this.doSearch=function(){var e=document.getElementById("military-branch"),t=document.getElementById("military-skill-level"),i=a._mosTextbox.val().trim(),l=l=(l=""!=(l=location.search.substr(1).split("&"))?l:[]).filter(function(e){return!(e.startsWith("branch=")||e.startsWith("skill=")||e.startsWith("mos="))}),e=(e&&e.options[e.selectedIndex].value&&l.push("branch="+e.options[e.selectedIndex].value),t&&t.options[t.selectedIndex].value&&l.push("skill="+t.options[t.selectedIndex].value),i?l.push("mos="+i):l.push("mos=All Other"),0!=l.length?"?"+l.join("&"):""),t=document.getElementById("results-page-link").value,i=window.location.protocol+"//"+window.location.host+t+e;window.location=encodeURI(i)},this.addEventListeners=function(){$(".military #military-search, .military-category #military-search").click(function(e){e.preventDefault(),a.doSearch()}),$("#military-branch").change(function(){a._branch=this.value,a.updateCustomLabels(),a.disableMilitaryCalculatorFields(),a.getSkillLevels()}),$("#military-skill-level").change(function(){a._skill=this.value,a.resetOccupationCode(),""===this.value?(a._mosTextbox.attr("disabled","disabled"),a._searchBtn.addClass("disabled")):(a._mosTextbox.removeAttr("disabled"),a._searchBtn.removeClass("disabled"),a.getOccupationalCodes())})},this.parseDropdownData=function(e,t){return e=(e=(e=e[t]&&0<e[t].length?e[t]:[]).filter(function(e){return"string"==typeof e})).map(function(e){return{name:e,value:e}})},this.updateCustomLabels=function(){var e=this._customLabels.find(function(e){return e.branch===a._branch});this.removeSkillLevelListOptions(e.skillLevel),this._mosTextbox.attr("placeholder",e.OccupationCode),this.resetOccupationCode()},this.clearMilitaryCalculatorFields=function(){this._branchDropdown.val(""),this._skillDropdown.val(""),this.resetOccupationCode()},this.resetOccupationCode=function(){this._mosTextbox.val(""),this._mosTextbox.parent().find("ul").html(""),this._mosTextbox.parent().find("ul").css("display","none"),this._autoComplete.updateData([])},this.disableMilitaryCalculatorFields=function(){this._skillDropdown.attr("disabled","disabled"),this._mosTextbox.attr("disabled","disabled"),this._searchBtn.addClass("disabled")},this.removeSkillLevelListOptions=function(e){e=e||"Skill Level";this._skillDropdown.find("option").not(":first").remove(),this._skillDropdown.find("option").first().text(e),this._searchBtn.addClass("disabled")}}function initMilitaryTestimonialSlick(){var e,t=".military .military-testimonial";0<$(t).length&&(0<(e=$(t+" .t-slider")).length&&e.slick({dots:!0,speed:300,slidesToShow:1,slidesToScroll:1,arrows:!0,autoplay:!0,autoplaySpeed:4e3}),0<$(t+" .slick-arrow").length&&$(t+" .t-slider").addClass("has-arrows"),0<$(t+" a.t-video").length)&&($(t+" a.t-video").attr("data-lity",""),$(t+" a.t-video").each(function(e){var t=$(this).data("src");$(this).attr("href",t)}))}document.addEventListener("DOMContentLoaded",function(e){$(document).foundation(),initMilitaryTestimonialSlick(),(new MilitaryCodeSearchV2).init()});